import{c,a as p,e as w,d as D,V as R,b as j,g as q,f as F}from"./VCard-Dx7sTbne.js";import{V as z,a as k}from"./VTextField-_cR0O_Sp.js";import{a as b,b as I,i as f,j as A,k as G}from"./index-BIT7kh2I.js";import{V as O}from"./VChip-CGXf3eV_.js";import{V as X}from"./VForm-alRvmnZJ.js";import{V as Y}from"./VSelectionControl-DUBgrwJs.js";import{V as Z}from"./VSwitch-DP3MYShV.js";import{b as d,l as H,_ as E,A as a,Y as r,X as m,Z as i,F as J,$ as K,V as y,a3 as S,U as V,G as Q}from"./vue-vendor-UqzHlSlI.js";import"./vuetify-e3zVlVid.js";import"./axios-R-lXtGyY.js";const se={__name:"SliderManagement",setup(W){const x=d(!1),s=d(!1),g=d(!1),U=d([]),u=d(null),v=d(""),n=d(!1),_=d(0),o=d({banner_title:"",banner_image_url:"",redirect_url:"",display_order:0,is_visible:!0}),C=async()=>{x.value=!0;try{const t=await p.get("/api/burma2d/sliders");U.value=t.data}catch(t){console.error("Error fetching sliders:",t)}finally{x.value=!1}},M=()=>{if(u.value){const t=new FileReader;t.onload=e=>{v.value=e.target.result},t.readAsDataURL(u.value)}},T=async()=>{if(!u.value)return null;const t=new FormData;t.append("image",u.value);try{return n.value=!0,(await p.post("/api/admin/upload-image",t,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:l=>{_.value=l.loaded/l.total*100}})).data.image_url}catch(e){throw console.error("Error uploading image:",e),e}finally{n.value=!1,_.value=0}},$=()=>{g.value=!1,u.value=null,v.value="",o.value={banner_title:"",banner_image_url:"",redirect_url:"",display_order:0,is_visible:!0},s.value=!0},B=t=>{g.value=!0,u.value=null,v.value=t.banner_image_url,o.value={...t},s.value=!0},L=async()=>{var t,e;try{if(u.value){const l=await T();l&&(o.value.banner_image_url=l)}g.value?await p.put(`/api/admin/sliders/${o.value.slider_id}`,o.value):await p.post("/api/admin/sliders",o.value),s.value=!1,await C()}catch(l){console.error("Error saving slider:",l),alert("Error: "+(((e=(t=l.response)==null?void 0:t.data)==null?void 0:e.error)||l.message))}},N=async t=>{if(confirm("Are you sure you want to delete this slider?"))try{await p.delete(`/api/admin/sliders/${t.slider_id}`),C()}catch(e){console.error("Error deleting slider:",e)}};return H(()=>{C()}),(t,e)=>(m(),E("div",null,[a(c,null,{default:r(()=>[a(w,{class:"d-flex align-center"},{default:r(()=>[a(b,{class:"mr-2"},{default:r(()=>[...e[7]||(e[7]=[i("mdi-image-multiple",-1)])]),_:1}),e[10]||(e[10]=i(" Slider Management ",-1)),a(I),a(f,{color:"primary",onClick:$},{default:r(()=>[a(b,{left:""},{default:r(()=>[...e[8]||(e[8]=[i("mdi-plus",-1)])]),_:1}),e[9]||(e[9]=i(" Add Slider ",-1))]),_:1})]),_:1}),a(D,null,{default:r(()=>[a(R,null,{default:r(()=>[(m(!0),E(J,null,K(U.value,l=>(m(),y(j,{key:l.slider_id,cols:"12",sm:"6",md:"4",lg:"3"},{default:r(()=>[a(c,null,{default:r(()=>[a(A,{src:l.banner_image_url,height:"200",cover:""},{default:r(()=>[a(O,{color:l.is_visible?"success":"error",class:"ma-2",size:"small"},{default:r(()=>[i(V(l.is_visible?"Active":"Inactive"),1)]),_:2},1032,["color"])]),_:2},1032,["src"]),a(w,null,{default:r(()=>[i("Slider "+V(l.display_order),1)]),_:2},1024),l.banner_title?(m(),y(q,{key:0},{default:r(()=>[i(V(l.banner_title),1)]),_:2},1024)):S("",!0),a(F,null,{default:r(()=>[a(f,{color:"primary",variant:"text",onClick:P=>B(l)},{default:r(()=>[a(b,{left:""},{default:r(()=>[...e[11]||(e[11]=[i("mdi-pencil",-1)])]),_:1}),e[12]||(e[12]=i(" Edit ",-1))]),_:1},8,["onClick"]),a(f,{color:"error",variant:"text",onClick:P=>N(l)},{default:r(()=>[a(b,{left:""},{default:r(()=>[...e[13]||(e[13]=[i("mdi-delete",-1)])]),_:1}),e[14]||(e[14]=i(" Delete ",-1))]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),a(z,{modelValue:s.value,"onUpdate:modelValue":e[6]||(e[6]=l=>s.value=l),"max-width":"600px"},{default:r(()=>[a(c,null,{default:r(()=>[a(w,null,{default:r(()=>[i(V(g.value?"Edit Slider":"Create Slider"),1)]),_:1}),a(D,null,{default:r(()=>[a(X,{ref:"form"},{default:r(()=>[a(k,{modelValue:o.value.banner_title,"onUpdate:modelValue":e[0]||(e[0]=l=>o.value.banner_title=l),label:"Title",required:""},null,8,["modelValue"]),a(Y,{modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=l=>u.value=l),label:"Upload Slider Image",accept:"image/*","prepend-icon":"mdi-camera",onChange:M,disabled:n.value},null,8,["modelValue","disabled"]),v.value?(m(),y(c,{key:0,class:"mb-4"},{default:r(()=>[a(A,{src:v.value,"max-height":"200",contain:""},null,8,["src"])]),_:1})):S("",!0),n.value?(m(),y(G,{key:1,"model-value":_.value,color:"primary",height:"25",striped:""},{default:r(()=>[Q("strong",null,V(Math.ceil(_.value))+"%",1)]),_:1},8,["model-value"])):S("",!0),a(k,{modelValue:o.value.redirect_url,"onUpdate:modelValue":e[2]||(e[2]=l=>o.value.redirect_url=l),label:"Link URL (optional)"},null,8,["modelValue"]),a(k,{modelValue:o.value.display_order,"onUpdate:modelValue":e[3]||(e[3]=l=>o.value.display_order=l),modelModifiers:{number:!0},label:"Display Order",type:"number"},null,8,["modelValue"]),a(Z,{modelValue:o.value.is_visible,"onUpdate:modelValue":e[4]||(e[4]=l=>o.value.is_visible=l),label:"Active",color:"success"},null,8,["modelValue"])]),_:1},512)]),_:1}),a(F,null,{default:r(()=>[a(I),a(f,{onClick:e[5]||(e[5]=l=>s.value=!1),disabled:n.value},{default:r(()=>[...e[15]||(e[15]=[i("Cancel",-1)])]),_:1},8,["disabled"]),a(f,{color:"primary",onClick:L,loading:n.value},{default:r(()=>[...e[16]||(e[16]=[i("Save",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{se as default};
